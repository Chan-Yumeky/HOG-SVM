# HOG + SVM 实现图像分类

### 需求

利用感应电机红外图像数据集，通过**HOG（Histogram of Oriented Gradients）**提取图像特征并使用**SVM（支持向量机）**实现图像的分类



### 项目架构

#### 文件夹

- `Dataset`：存放图像的数据集，包括原始全部图像all_dataset和各个比例的训练集和测试集。我们做了一个训练集测试集分别是五五分、六四分、七三分、八二分、九一分的实现，进行改进升级。相同数字代表同一组，例如train73和test73为同一组，表示训练集数据量：测试集数据量 = 7:3。原始分类如下：

![classify.png](https://github.com/JackieLin2004/Image_Recognition/blob/master/classify.png?raw=true)

- `reference_code`：本项目的参考代码及博客，请遵守开源协议
- `feat`：存放提取图像的特征，特征文件以 .feat 作为后缀名
- `mode`l：存放训练好的模型



#### 工程文件

- `export_test_label.py`：用于导出测试集所需的标签并存放于txt文件
- `export_train_label.py`：用于导出训练集所需的标签并存放于txt文件
- `original_grey_hog_svm.py`：参考并改写的实现对灰度图像（grey）的分类
- `rgb_svm.py`：根据代码思路重写逻辑，实现对彩色图像（RGB）的分类并进行特征提取和模型训练的优化



### 实现思路

仅以实现<u>彩色图像</u>的图像分类为例——

- #### **数据准备**

  - 通过`export_train_label.py`和`export_test_label.py`将各个比例的训练集和测试集打上标签，做好分类的预处理

  - 设定训练集和测试集的图像和标签路径

  - 设定图像的尺寸参数，以便在后续处理步骤中统一图像的大小

- #### **获取图像列表**

  - 通过  *get_image_list*  函数，读取指定路径下的所有图像，并将它们存储在列表中。该函数确保图像资源被正确释放

- #### **提取图像特征**

  - 使用  *get_color_hog_features*  函数对每张图像的每个颜色通道（RGB）分别提取 HOG 特征。HOG 特征提取的步骤包括：
    - 将图像分成多个小的单元格（cell）
    - 在每个单元格中计算梯度方向直方图
    - 将多个单元格组合成块（block），并在块内进行归一化处理
    - 将每个颜色通道的 HOG 特征合并成一个一维特征向量

- #### **保存特征**

  - 通过  *get_feat*  函数，提取图像的 HOG 特征，并将这些特征与对应的标签一起保存到磁盘。保存路径分为训练集特征路径和测试集特征路径

- #### **创建目录（若初始没有该目录）**

  - 使用 `mkdir` 函数创建存放训练集和测试集特征的目录

- #### **特征提取**

  - 检查是否需要重新提取特征。如果需要，删除现有特征文件夹并重新提取特征
  - 读取提取的特征和标签，准备进行模型训练

- #### **模型训练与保存**

  - 使用 SVM 分类器进行模型训练。本项目选择的是线性核的 SVM，并启用概率估计
  - 模型训练完成后，将模型保存到指定路径，以便后续使用

- #### **模型预测与评估**

  - 读取测试集的特征和标签，使用训练好的 SVM 模型进行预测
  - 计算预测的准确率（Accuracy）、精确率（precision）、召回率（recall）和损失（log loss）
  - 将预测结果写入 `result.txt` 文件中，每行记录对应图像的文件名、实际标签和预测标签



### 代码流程

1. **数据准备与目录创建** —— 初始化路径、图像尺寸等参数，确保特征存储目录存在。
2. **特征提取** —— 检查是否需要重新提取特征，重新提取会直接覆盖原有特征文件；读取图像并对每张图像提取 HOG 特征，将特征保存到磁盘。
3. **模型训练** —— 检查是否需要重新训练模型，若需要则使用提取的训练集特征进行训练并保存模型。
4. **模型测试** —— 读取测试集特征，使用训练好的模型进行预测，而后计算并输出模型的性能指标，记录每个测试样本的实际标签和预测标签。



### 优缺点分析

- #### 优点

  - HOG 特征能够捕捉图像的局部梯度信息，尤其适用于检测和分类具有明显边缘和纹理特征的物体，因此实际使用场景大多为人脸检测、物体识别等。
  - SVM 是一种强大的分类器，尤其适合小样本高维数据，可以通过选择合适的核函数来处理非线性问题。

- #### 缺点

  - HOG 特征对图像的旋转和缩放不敏感，无法像卷积神经网络（CNN）一样实现数据增强，在模型预测中也可能导致对这类变换不鲁棒（稳健）。
  - SVM 训练时间较长，尤其是在样本数量较大时，训练过程可能会比较耗时，但相比较CNN而言在保证准确率足够高的情况下可以接受此程度的训练时长。



### 此项目仅供学习交流使用，转载请注明出处！